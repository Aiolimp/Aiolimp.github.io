---
title: base64格式的数据是如何实现的
date: 2021-04-23 16:57:49
top_img: https://static001.geekbang.org/resource/image/73/e4/730ea9c393def7975deceb48b3eb6fe4.jpg
cover: https://static001.geekbang.org/resource/image/73/e4/730ea9c393def7975deceb48b3eb6fe4.jpg
tags:
- Base64
categories:
- Base64
aplayer: true
---

# base64格式的数据是如何实现的

Base64是网络上最常见的用于传输8Bit字节码的编码方式之一，Base64就是一种基于64个可打印字符来表示二进制数据的方法

对于前端来说，一切可以放路径的地方，都可以使用base64来替代。

node中的buffer对象可以通过toString('base64')将buffer对象输出为base64。我们这里来简述一下汉字是如何转换成为base64的实现原理。

比如我们来探索一下汉子"哈"通过base64的转换结果为"5ZOI"是如何实现的。

首先我们利用nodejs中Buffer对象的from方法，将汉子转换为buffer对象。可以得到e5 93 88三个16进制的字节。可以看到这个函子由3个字节组成。

```js
const buf = Buffer.from("哈");
console.log(buf); // // e5 93 88
```

然后再将每个字节转换为二进制, 0x代表16进制，我们需要在e5 93 88前面分别拼上0x, toString方法中可以传入要转换的字进制，这里写2。

```js
// 将每个字节转为二进制
(0xe5).toString(2); // 11100101
(0x93).toString(2); // 10010011
(0x88).toString(2); // 10001000
```

接着将得到的三个2进制数据连接在一起，得到111001011001001110001000。

```js
111001011001001110001000
```

然后将111001011001001110001000每六个一组进行切割，这里可以切割为4部分。

```js
111001 011001 001110 001000
```

接着再每一组的前面用0补位，凑成8位。

```js
00111001
00011001
00001110
00001000
```

将得到的四组数据分别再转换为10进制数据。这里一共可以获得4个数字，是不是"哈"这个字转换为base64后获取到的4个字符有些接近了。

```js
parseInt('00111001', 2); // 二进制变为10进制 57
parseInt('00011001', 2); // 二进制变为10进制 25
parseInt('00001110', 2); // 二进制变为10进制 14
parseInt('00001000', 2); // 二进制变为10进制 8
```

base64的编码数据基本是从A-Z加上a-z再加上0123456789+/中获取的。我们拼接出这个字符串。

```js
// base64编码
let str = 'ABCDEFGHIGKLMNOPQRSTUVWSYZ';
str += str.toLowerCase(); // 小写字符拼接一次
str += '0123456789+/'; // 数字拼接一次
```

我们知道，字符串可以类似数组一样通过下标来获取指定位置的字符，这里通过上面10进制转换之后的值分别获取对应位置的字符，57获取的就是5，25获取的就是Z，14获取的就是O，8获取的就是I。

将这四个字符拼接在一起就是5ZOI。就是之前转换后的base64。

```js
const base64 = str[57] + str[25] + str[14] + str[8]; // 5ZOI
```

#### base64转译步骤

1、将字符串通过Buffer.from获取buffer，并将buffer中的每个16的buffer字节转为2进制

2、将所有二进制拼接在一起，6个一组进行划分，在前面补00，凑成8位二进制

3、将新的二进制转换成10进制

4、在base64集合中分别通过10进制下标取出，并链接

转载至：https://juejin.cn/post/6913532512346046472